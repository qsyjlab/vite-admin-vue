import{U as j,O as q}from"./index.ghQPKumy.js";import{K as A}from"./index-1bc4de67.W6DM0pGT.js";import{d as b,h as g,g as v,j as S,D as c,o as _,b as x,w as i,I as u,a as z,k as a,t as B}from"./framework.e2dboEyh.js";import"../app.kf9R8BQv.js";import"./theme.2Uqr2FmO.js";const O={class:"custom-tree-node"},R=a("span",null,null,-1),U=b({__name:"catalogue-tree",props:{data:{}},setup(k){function s(d){var r;return(r=d.el)==null?void 0:r.innerText}return(d,r)=>{const p=c("el-tree");return _(),x(p,{data:d.data,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},{default:i(({data:h})=>[a("span",O,[a("span",null,B(s(h)),1),R])]),_:1},8,["data"])}}}),V={id:"wrap"},D=a("p",{contenteditable:""},"致某人xxxx：",-1),F=a("p",{style:{"text-indent":"2em"}},"测试正文内容",-1),I=a("p",{style:{"text-indent":"2em"},contenteditable:""},"二级标题的正文",-1),K=a("h3",null,"（一）三级标题",-1),M=a("h3",null,"（二）三级标题",-1),P=a("h4",null,"（1.）四季级标题",-1),G=a("h4",null,"（1.）四季级标题",-1),H=a("h4",null,"（1.）四季级标题",-1),J=a("h4",null,"（1.）四季级标题",-1),Q=a("h2",{contenteditable:""},"一、测试二级标题",-1),W=a("p",{style:{"text-indent":"2em"},contenteditable:""},"二级标题的正文",-1),X=a("h2",{contenteditable:""},"一、测试二级标题",-1),Y=a("p",{style:{"text-indent":"2em"},contenteditable:""},"二级标题的正文",-1),ae=b({__name:"template",setup(k){const s=g(),d=["h1","h2","h3","h4"],r=g([]),p=v(()=>"oxide"),h=v(()=>"zh_CN");S(()=>{w()});const y=v(()=>C(r.value));function m(t){t.addEventListener("mouseover",n=>{if(console.log("over"),n.stopPropagation(),t.querySelector(".add-handle"))return;const e=document.createElement("div");e.classList.add("add-handle"),e.innerText="添加",e.addEventListener("click",()=>{var l;const o=document.createElement("h2");o.setAttribute("contenteditable",""),o.innerText="测试新增的东西",m(o),(l=s.value)==null||l.append(o)}),t.append(e)}),t.addEventListener("mouseleave",()=>{var n;(n=t.querySelector(".add-handle"))==null||n.remove()})}function w(){var t;const n=(t=s.value)==null?void 0:t.querySelectorAll("h1,h2,h3,h4");n!=null&&n.length&&(Array.from(n).forEach(e=>{var l;r.value.push({label:e.textContent||"",id:"",el:e,level:Number((l=e.tagName)==null?void 0:l.substring(1,2))}),m(e)}),console.log(" headings.value",r.value))}function L(t){const n=t.target.tagName;d.includes(n.toLocaleLowerCase())&&N()}function N(){var t;r.value=[];const n=(t=s.value)==null?void 0:t.querySelectorAll(d.join(","));n!=null&&n.length&&Array.from(n).forEach(e=>{var l;r.value.push({label:e.textContent||"",id:"",el:e,level:Number((l=e.tagName)==null?void 0:l.substring(1,2))})})}function C(t){const n=[];let e=[];return t.forEach(l=>{const o={id:l.id,label:l.label,level:l.level,children:[],el:l.el};for(;e.length>0&&e[e.length-1].level>=l.level;)e.pop();e.length===0?n.push(o):e[e.length-1].children&&e[e.length-1].children.push(o),e.push(o)}),n}function f(t){const n=t.target,e="/";n.dataset;const l=`${e}resource/tinymce`;j.init({selector:".edit-class-2",inline:!0,skin_url:`${l}/skins/ui/${p.value}`,branding:!1,codesample_preview:!0,default_link_target:"_blank",link_title:!1,object_resizing:!1,auto_focus:!0,content_css:`${l}/skins/content/default/content.css`,language_url:`${l}/langs/${h.value}.js`,toolbar:"bold italic underline strikethrough | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist | outdent indent blockquote | undo redo | link unlink image code | removeformat"})}const E=()=>{var t;const n=((t=s.value)==null?void 0:t.outerHTML)||"";A(n).then(e=>{q(URL.createObjectURL(e),`${new Date().getTime()}.docx`)})};return(t,n)=>{const e=c("el-button"),l=c("el-col"),o=c("el-row"),$=c("page-card"),T=c("page-wrapper");return _(),x(T,null,{default:i(()=>[u($,{header:t.$route.meta.title},{default:i(()=>[u(e,{type:"primary",class:"mb-20px",onClick:E},{default:i(()=>[z("导出 word")]),_:1}),u(o,null,{default:i(()=>[u(l,{span:7},{default:i(()=>[u(U,{data:y.value},null,8,["data"])]),_:1}),u(l,{span:17},{default:i(()=>[a("div",V,[a("div",{ref_key:"templateRef",ref:s,class:"template",onInput:L},[a("h2",{class:"edit-class-1","data-edit-id":"2",contenteditable:"",onFocus:f}," xxx情况报告 ",32),D,F,a("h2",{"data-edit-id":"3",class:"edit-class-2",contenteditable:"",onFocus:f}," 一、测试二级标题 ",32),I,K,M,P,G,H,J,Q,W,X,Y],544)])]),_:1})]),_:1})]),_:1},8,["header"])]),_:1})}}});export{ae as default};
