import{R as j,M as A}from"./index.mdm6ka2m.js";import{K as q}from"./index-c6368b41.HIoBPkOL.js";import{d as b,h as g,g as m,j as R,D as u,o as x,b as _,w as d,I as c,a as S,k as a,t as V,e as B}from"./framework.kGBdJdCt.js";import"../app.4OzQX80d.js";import"./theme.IDZC-AZR.js";const D={class:"custom-tree-node"},M=a("span",null,[B(` <a @click="append(data)"> Append </a>
          <a style="margin-left: 8px" @click="remove(node, data)"> Delete </a> `)],-1),z=b({__name:"catalogue-tree",props:{data:{}},setup(k){function s(i){var r;return(r=i.el)==null?void 0:r.innerText}return(i,r)=>{const p=u("el-tree");return x(),_(p,{data:i.data,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},{default:d(({data:h})=>[a("span",D,[a("span",null,V(s(h)),1),M])]),_:1},8,["data"])}}}),F={id:"wrap"},I=a("p",{contenteditable:""},"致某人xxxx：",-1),K=a("p",{style:{"text-indent":"2em"}},"测试正文内容",-1),O=a("p",{style:{"text-indent":"2em"},contenteditable:""},"二级标题的正文",-1),U=a("h3",null,"（一）三级标题",-1),P=a("h3",null,"（二）三级标题",-1),Z=a("h4",null,"（1.）四季级标题",-1),G=a("h4",null,"（1.）四季级标题",-1),H=a("h4",null,"（1.）四季级标题",-1),J=a("h4",null,"（1.）四季级标题",-1),Q=a("h2",{contenteditable:""},"一、测试二级标题",-1),W=a("p",{style:{"text-indent":"2em"},contenteditable:""},"二级标题的正文",-1),X=a("h2",{contenteditable:""},"一、测试二级标题",-1),Y=a("p",{style:{"text-indent":"2em"},contenteditable:""},"二级标题的正文",-1),oe=b({__name:"template",setup(k){const s=g(),i=["h1","h2","h3","h4"],r=g([]),p=m(()=>"oxide"),h=m(()=>"zh_CN");R(()=>{N()});const y=m(()=>L(r.value));function v(t){t.addEventListener("mouseover",n=>{if(console.log("over"),n.stopPropagation(),t.querySelector(".add-handle"))return;const e=document.createElement("div");e.classList.add("add-handle"),e.innerText="添加",e.addEventListener("click",()=>{var l;const o=document.createElement("h2");o.setAttribute("contenteditable",""),o.innerText="测试新增的东西",v(o),(l=s.value)==null||l.append(o)}),t.append(e)}),t.addEventListener("mouseleave",()=>{var n;(n=t.querySelector(".add-handle"))==null||n.remove()})}function N(){var t;const n=(t=s.value)==null?void 0:t.querySelectorAll("h1,h2,h3,h4");n!=null&&n.length&&(Array.from(n).forEach(e=>{var l;r.value.push({label:e.textContent||"",id:"",el:e,level:Number((l=e.tagName)==null?void 0:l.substring(1,2))}),v(e)}),console.log(" headings.value",r.value))}function w(t){const n=t.target.tagName;i.includes(n.toLocaleLowerCase())&&C()}function C(){var t;r.value=[];const n=(t=s.value)==null?void 0:t.querySelectorAll(i.join(","));n!=null&&n.length&&Array.from(n).forEach(e=>{var l;r.value.push({label:e.textContent||"",id:"",el:e,level:Number((l=e.tagName)==null?void 0:l.substring(1,2))})})}function L(t){const n=[];let e=[];return t.forEach(l=>{const o={id:l.id,label:l.label,level:l.level,children:[],el:l.el};for(;e.length>0&&e[e.length-1].level>=l.level;)e.pop();e.length===0?n.push(o):e[e.length-1].children&&e[e.length-1].children.push(o),e.push(o)}),n}function f(t){const n=t.target,e="/";n.dataset;const l=`${e}resource/tinymce`;j.init({selector:".edit-class-2",inline:!0,skin_url:`${l}/skins/ui/${p.value}`,branding:!1,codesample_preview:!0,default_link_target:"_blank",link_title:!1,object_resizing:!1,auto_focus:!0,content_css:`${l}/skins/content/default/content.css`,language_url:`${l}/langs/${h.value}.js`,toolbar:"bold italic underline strikethrough | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist | outdent indent blockquote | undo redo | link unlink image code | removeformat"})}const E=()=>{var t;const n=((t=s.value)==null?void 0:t.outerHTML)||"";q(n).then(e=>{A(URL.createObjectURL(e),`${new Date().getTime()}.docx`)})};return(t,n)=>{const e=u("el-button"),l=u("el-col"),o=u("el-row"),$=u("page-card"),T=u("page-wrapper");return x(),_(T,null,{default:d(()=>[c($,{header:t.$route.meta.title},{default:d(()=>[c(e,{type:"primary",class:"mb-20px",onClick:E},{default:d(()=>[S("导出 word")]),_:1}),c(o,null,{default:d(()=>[c(l,{span:7},{default:d(()=>[c(z,{data:y.value},null,8,["data"])]),_:1}),c(l,{span:17},{default:d(()=>[a("div",F,[a("div",{ref_key:"templateRef",ref:s,class:"template",onInput:w},[a("h2",{class:"edit-class-1","data-edit-id":"2",contenteditable:"",onFocus:f}," xxx情况报告 ",32),I,K,a("h2",{"data-edit-id":"3",class:"edit-class-2",contenteditable:"",onFocus:f}," 一、测试二级标题 ",32),O,U,P,Z,G,H,J,Q,W,X,Y],544)])]),_:1})]),_:1})]),_:1},8,["header"])]),_:1})}}});export{oe as default};
