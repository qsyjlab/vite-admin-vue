import{z as R,x as C,a8 as P,A as m,a as b,n as w,b as s,W as c,K as D,G as y}from"./index.CXx_r3g5.js";import{f as $}from"./index-ovEa40aM.7wa4RGt0.js";import"./framework.CtQlGyLl.js";import"./theme.lKphzJcC.js";const I=R({__name:"mutiple-header",setup(v){const d=C([]),{register:_,getTableRef:k}=P();d.value=L();const u=[{title:"ID",key:"id"},{title:"姓名",key:"namer",children:[{title:"姓名1",key:"name1",children:[{title:"姓名",key:"name",children:[]},{title:"姓名2",key:"name2",children:[]}]},{title:"姓名2",key:"name1",children:[]}]},{title:"年龄",key:"age"},{title:"编号",key:"code"},{title:"地址",key:"address"},{title:"开始时间",key:"startTime"},{title:"结束时间",key:"endTime"}],x=({row:a,column:t,rowIndex:e,columnIndex:i})=>{if(e%2===0){if(i===0)return[1,2];if(i===1)return[0,0]}},A=async()=>{const a=h(u);T(a);const t=await k();console.log("tableRef",t)},E=()=>{const a={};u.forEach(e=>{a[e.key]=e.title});const t=h(u);$({data:[],merges:[],header:t,filename:`${new Date().getTime()}.xlsx`,json2sheetOpts:{header:t},write2excelOpts:{bookType:"xlsx"}})};function h(a){let t=[];f(a,t,0,0);let e=Math.max(...t.map(i=>i.length));return t.filter(i=>i.length<e).forEach(i=>p(i,e-i.length)),t}function f(a,t,e,i){let n=0,r=t[e];r||(r=t[e]=[]),p(r,i-r.length);for(let l=0;l<a.length;l++){let o=a[l];if(r.push(o.title),o.hasOwnProperty("children")&&Array.isArray(o.children)&&o.children.length>0){let g=f(o.children,t,e+1,r.length-1);O(r,g-1),n+=g}else n++}return n}function O(a,t){for(let e=0;e<t;e++)a.push("!$COL_SPAN_PLACEHOLDER")}function p(a,t){for(let e=0;e<t;e++)a.push("!$ROW_SPAN_PLACEHOLDER")}function T(a){let t=a.length,e=[];for(let n=0;n<t;n++){let r=a[n],l=0;for(let o=0;o<r.length;o++)r[o]==="!$COL_SPAN_PLACEHOLDER"?(r[o]=void 0,o+1===r.length&&e.push({s:{r:n,c:o-l-1},e:{r:n,c:o}}),l++):(l>0&&o>l&&e.push({s:{r:n,c:o-l-1},e:{r:n,c:o-1}}),l=0)}let i=a[0].length;for(let n=0;n<i;n++){let r=0;for(let l=0;l<t;l++)a[l][n]==="!$ROW_SPAN_PLACEHOLDER"?(a[l][n]=void 0,r++,l+1===t&&e.push({s:{r:l-r,c:n},e:{r:l,c:n}})):(r>0&&l>r&&e.push({s:{r:l-r-1,c:n},e:{r:l-1,c:n}}),r=0)}return e}function L(){return[{id:"12987122",name:"Tom",amount1:"234",amount2:"3.2",amount3:10},{id:"12987123",name:"Tom",amount1:"165",amount2:"4.43",amount3:12},{id:"12987124",name:"Tom",amount1:"324",amount2:"1.9",amount3:9},{id:"12987125",name:"Tom",amount1:"621",amount2:"2.2",amount3:17},{id:"12987126",name:"Tom",amount1:"539",amount2:"4.1",amount3:15}]}return(a,t)=>{const e=m("el-button"),i=m("pro-table"),n=m("page-card"),r=m("page-wrapper");return b(),w(r,null,{default:s(()=>[c(n,{header:a.$route.meta.title},{default:s(()=>[c(i,{columns:u,data:d.value,"span-method":x,onRegister:D(_)},{toolbar:s(()=>[c(e,{onClick:A},{default:s(()=>[y("数组方式导出")]),_:1}),c(e,{onClick:E},{default:s(()=>[y("导出")]),_:1})]),_:1},8,["data","onRegister"])]),_:1},8,["header"])]),_:1})}}});export{I as default};
