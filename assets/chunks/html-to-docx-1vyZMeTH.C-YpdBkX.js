import{G as C,C as A,E as F,P as L,M as x,Q as b,S as k,Y as O,a0 as d}from"./index.BY2CIEfQ.js";import{r as j}from"./index-JsRk2Tcq.BWD6DOo9.js";import{d as R,h as $,E as f,o as V,b as z,w as h,J as m,a as B,p as D,ba as N}from"./framework.DHfpg7u7.js";import"./theme.CTPVtnNN.js";const G=/;(?![^(]*\))/g,I=/:([^]+)/,M=/\/\*[^]*?\*\//g;function U(e){const t={};return e.replace(M,"").split(G).forEach(n=>{if(n){const r=n.split(I);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}const q={color:{property:"color",handler:e=>s(e)},backgroundColor:{property:"shading",handler:e=>({type:k.SOLID,color:s(e),fill:s(e)})},textDecoration:{property:"underline",handler:(e,t)=>({type:O.SINGLE,color:t.color?s(t.color):void 0})},fontSize:{property:"size",handler:e=>W(e)},textIndent:{property:"indent",handler:(e,t)=>{const n=u(t.fontSize),r=u(e);return{firstLine:J(n*r)}}},textAlign:{property:"alignment",handler:e=>e==="center"?d.CENTER:e==="right"?d.RIGHT:d.LEFT},fontWeight:{property:"bold",handler:e=>!!e},fontFamily:{property:"font",handler:e=>e},lineHeight:{property:"lineSpacing",handler:e=>{if(e)return u(e)*20}}},H={em:{property:"italics",handler:()=>!0},strong:{property:"bold",handler:()=>!0}};function y(e){const t={};return Object.keys(e).forEach(n=>{const r=N(n),o=e[n],a=q[r];if(a){t[a.property]=a.handler(o,e);return}t[r]=o}),t}function P(e){const t={};return e.forEach(n=>{const r=H[n];r&&(t[r.property]=r.handler())}),t}function g(e){var t;const n={},r=U(((t=e==null?void 0:e.style)==null?void 0:t.cssText)||"");return Object.keys(r).forEach(o=>{n[N(o)]=r[o]}),n}function W(e){return u(e)*2}function J(e){return e*20}function u(e){const t=e.match(/(\d+(\.\d+)?)/);return t?parseFloat(t[0]):0}function s(e){if(Q(e))return e;const t=e.match(/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*[\d.]+)?\)$/);function n(r){const o=Number(r).toString(16);return o.length===1?"0"+o:o}if(t){const r=n(t[1]),o=n(t[2]),a=n(t[3]);return"#"+r+o+a}else return e}function Q(e){return/^#(?:[A-Fa-f0-9]{3}){1,2}$|^#(?:[A-Fa-f0-9]{4}){1,2}$/.test(e)}function X(e){const t=[];return(Array.isArray(e)?e:[e]).forEach(n=>{t.push(new x({pageBreakBefore:!0})),t.push(...Y(n))}),t}function Y(e){const t=document.createElement("div");t.innerHTML=e;const n=new DOMParser().parseFromString(e,"text/html"),r=[];return n.body.querySelectorAll("p,h1,h2,h3,h4,h6").forEach(o=>{const a=[],i=y(g(o));o.childNodes.forEach(c=>{if(c.nodeType===Node.TEXT_NODE)a.push(new b({text:c.textContent||"",...E(y(g(c)),i)}));else if(c.nodeType===Node.ELEMENT_NODE){const l=c,T=["strong","em","i"],w=Array.from(l.querySelectorAll(T.join(","))).map(S=>S.tagName.toLowerCase()),_=P(w),v=E(E(y(g(l)),i),_);a.push(new b({text:l.textContent,...v}))}});const p=new x({children:a,spacing:{line:i.lineSpacing,lineRule:"exact"},alignment:i.alignment,indent:i.indent});r.push(p)}),r}function E(e,t){return Object.keys(t).forEach(n=>{t[n]!==void 0&&(e[n]=t[n])}),e}function Z(e,t){K(ee(e)).then(n=>{const r=URL.createObjectURL(n);A(r,t?`${t}.docx`:void 0)})}function K(e){return F.toBlob(e)}function ee(e){return new L({features:{updateFields:!0},sections:[{properties:{page:{margin:{top:1814,bottom:1814,left:1417,right:1417},size:{width:11906,height:16838}}},children:X(e)}]})}const ae=R({__name:"html-to-docx",setup(e){const t=C(),n=$(""),r=()=>{Z(n.value,t.meta.title)};return(o,a)=>{const i=f("el-button"),p=f("page-card"),c=f("page-wrapper");return V(),z(c,null,{default:h(()=>[m(p,{header:o.$route.meta.title},{default:h(()=>[m(i,{type:"primary",class:"mb-20px",onClick:r},{default:h(()=>[B("导出 word")]),_:1}),m(D(j),{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value=l)},null,8,["modelValue"])]),_:1},8,["header"])]),_:1})}}});export{ae as default};
