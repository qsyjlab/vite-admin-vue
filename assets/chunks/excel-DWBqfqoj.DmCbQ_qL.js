import"./index.B_-AZqtN.js";import{c as x,f as h}from"./index-BPEdS0SZ.BViMSPAt.js";import{d as w,h as y,E as r,o as _,b as T,w as a,J as l,a as i}from"./framework.D1sHVKzl.js";import"./theme.af-yJUCQ.js";const C=w({__name:"excel",setup(g){const o=y([]);o.value=m();const n=[{title:"ID",key:"id"},{title:"姓名",key:"name"},{title:"年龄",key:"age"},{title:"编号",key:"code"},{title:"地址",key:"address"},{title:"开始时间",key:"startTime"},{title:"结束时间",key:"endTime"}],d=()=>{x({data:p(),header:n.map(t=>t.title),filename:"二维数组方式导出excel.xlsx"})},c=()=>{const t={};n.forEach(e=>{t[e.key]=e.title}),h({data:o.value,header:t,filename:`${new Date().getTime()}.xlsx`,json2sheetOpts:{header:["name","id"]},write2excelOpts:{bookType:"xlsx"}})};function m(){const t=[];for(let e=0;e<40;e++)t.push({id:`${e}`,name:`${e} John Brown`,age:`${e+10}`,code:`${e}98678`,address:"New York No. 1 Lake ParkNew York No. 1 Lake Park",startTime:new Date().toLocaleString(),endTime:new Date().toLocaleString()});return t}function p(){return o.value.map(t=>Object.keys(t).map(e=>t[e]))}return(t,e)=>{const s=r("el-button"),u=r("pro-table"),k=r("page-card"),f=r("page-wrapper");return _(),T(f,null,{default:a(()=>[l(k,{header:t.$route.meta.title},{default:a(()=>[l(u,{columns:n,data:o.value},{toolbar:a(()=>[l(s,{onClick:d},{default:a(()=>e[0]||(e[0]=[i("数组方式导出")])),_:1}),l(s,{onClick:c},{default:a(()=>e[1]||(e[1]=[i("导出")])),_:1})]),_:1},8,["data"])]),_:1},8,["header"])]),_:1})}}});export{C as default};
