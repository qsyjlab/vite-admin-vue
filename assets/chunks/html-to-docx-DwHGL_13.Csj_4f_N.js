import{n as C,Q as L,R as _,S as $,T as x,$ as b,V as k,W as O,_ as d}from"./index.B_-AZqtN.js";import{r as j}from"./index-Dlf_k71C.CpzSw_NM.js";import{d as F,h as V,E as f,o as B,b as R,w as h,J as m,a as z,p as D,bb as N}from"./framework.D1sHVKzl.js";import"./theme.af-yJUCQ.js";const I=/;(?![^(]*\))/g,U=/:([^]+)/,G=/\/\*[^]*?\*\//g;function M(e){const t={};return e.replace(G,"").split(I).forEach(n=>{if(n){const r=n.split(U);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}const q={color:{property:"color",handler:e=>s(e)},backgroundColor:{property:"shading",handler:e=>({type:k.SOLID,color:s(e),fill:s(e)})},textDecoration:{property:"underline",handler:(e,t)=>({type:O.SINGLE,color:t.color?s(t.color):void 0})},fontSize:{property:"size",handler:e=>J(e)},textIndent:{property:"indent",handler:(e,t)=>{const n=u(t.fontSize),r=u(e);return{firstLine:P(n*r)}}},textAlign:{property:"alignment",handler:e=>e==="center"?d.CENTER:e==="right"?d.RIGHT:d.LEFT},fontWeight:{property:"bold",handler:e=>!!e},fontFamily:{property:"font",handler:e=>e},lineHeight:{property:"lineSpacing",handler:e=>{if(e)return u(e)*20}}},H={em:{property:"italics",handler:()=>!0},strong:{property:"bold",handler:()=>!0}};function y(e){const t={};return Object.keys(e).forEach(n=>{const r=N(n),o=e[n],a=q[r];if(a){t[a.property]=a.handler(o,e);return}t[r]=o}),t}function W(e){const t={};return e.forEach(n=>{const r=H[n];r&&(t[r.property]=r.handler())}),t}function g(e){var t;const n={},r=M(((t=e==null?void 0:e.style)==null?void 0:t.cssText)||"");return Object.keys(r).forEach(o=>{n[N(o)]=r[o]}),n}function J(e){return u(e)*2}function P(e){return e*20}function u(e){const t=e.match(/(\d+(\.\d+)?)/);return t?parseFloat(t[0]):0}function s(e){if(Q(e))return e;const t=e.match(/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*[\d.]+)?\)$/);function n(r){const o=Number(r).toString(16);return o.length===1?"0"+o:o}if(t){const r=n(t[1]),o=n(t[2]),a=n(t[3]);return"#"+r+o+a}else return e}function Q(e){return/^#(?:[A-Fa-f0-9]{3}){1,2}$|^#(?:[A-Fa-f0-9]{4}){1,2}$/.test(e)}function X(e){const t=[];return(Array.isArray(e)?e:[e]).forEach(n=>{t.push(new x({pageBreakBefore:!0})),t.push(...Y(n))}),t}function Y(e){const t=document.createElement("div");t.innerHTML=e;const n=new DOMParser().parseFromString(e,"text/html"),r=[];return n.body.querySelectorAll("p,h1,h2,h3,h4,h6").forEach(o=>{const a=[],i=y(g(o));o.childNodes.forEach(c=>{if(c.nodeType===Node.TEXT_NODE)a.push(new b({text:c.textContent||"",...E(y(g(c)),i)}));else if(c.nodeType===Node.ELEMENT_NODE){const l=c,T=["strong","em","i"],w=Array.from(l.querySelectorAll(T.join(","))).map(A=>A.tagName.toLowerCase()),v=W(w),S=E(E(y(g(l)),i),v);a.push(new b({text:l.textContent,...S}))}});const p=new x({children:a,spacing:{line:i.lineSpacing,lineRule:"exact"},alignment:i.alignment,indent:i.indent});r.push(p)}),r}function E(e,t){return Object.keys(t).forEach(n=>{t[n]!==void 0&&(e[n]=t[n])}),e}function K(e,t){Z(ee(e)).then(n=>{const r=URL.createObjectURL(n);L(r,t?`${t}.docx`:void 0)})}function Z(e){return _.toBlob(e)}function ee(e){return new $({features:{updateFields:!0},sections:[{properties:{page:{margin:{top:1814,bottom:1814,left:1417,right:1417},size:{width:11906,height:16838}}},children:X(e)}]})}const ae=F({__name:"html-to-docx",setup(e){const t=C(),n=V(""),r=()=>{K(n.value,t.meta.title)};return(o,a)=>{const i=f("el-button"),p=f("page-card"),c=f("page-wrapper");return B(),R(c,null,{default:h(()=>[m(p,{header:o.$route.meta.title},{default:h(()=>[m(i,{type:"primary",class:"mb-20px",onClick:r},{default:h(()=>a[1]||(a[1]=[z("导出 word")])),_:1}),m(D(j),{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value=l)},null,8,["modelValue"])]),_:1},8,["header"])]),_:1})}}});export{ae as default};
