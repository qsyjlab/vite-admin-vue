import{z as x,x as y,A as r,a as _,n as h,b as a,W as l,G as s}from"./index.CXx_r3g5.js";import{c as g,f as w}from"./index-ovEa40aM.7wa4RGt0.js";import"./framework.CtQlGyLl.js";import"./theme.lKphzJcC.js";const D=x({__name:"excel",setup(T){const o=y([]);o.value=m();const n=[{title:"ID",key:"id"},{title:"姓名",key:"name"},{title:"年龄",key:"age"},{title:"编号",key:"code"},{title:"地址",key:"address"},{title:"开始时间",key:"startTime"},{title:"结束时间",key:"endTime"}],d=()=>{g({data:u(),header:n.map(e=>e.title),filename:"二维数组方式导出excel.xlsx"})},c=()=>{const e={};n.forEach(t=>{e[t.key]=t.title}),w({data:o.value,header:e,filename:`${new Date().getTime()}.xlsx`,json2sheetOpts:{header:["name","id"]},write2excelOpts:{bookType:"xlsx"}})};function m(){const e=[];for(let t=0;t<40;t++)e.push({id:`${t}`,name:`${t} John Brown`,age:`${t+10}`,code:`${t}98678`,address:"New York No. 1 Lake ParkNew York No. 1 Lake Park",startTime:new Date().toLocaleString(),endTime:new Date().toLocaleString()});return e}function u(){return o.value.map(e=>Object.keys(e).map(t=>e[t]))}return(e,t)=>{const i=r("el-button"),k=r("pro-table"),p=r("page-card"),f=r("page-wrapper");return _(),h(f,null,{default:a(()=>[l(p,{header:e.$route.meta.title},{default:a(()=>[l(k,{columns:n,data:o.value},{toolbar:a(()=>[l(i,{onClick:d},{default:a(()=>[s("数组方式导出")]),_:1}),l(i,{onClick:c},{default:a(()=>[s("导出")]),_:1})]),_:1},8,["data"])]),_:1},8,["header"])]),_:1})}}});export{D as default};
