import{d as D,an as V,Y,h as $,k as O,U as I,E as w,o as l,c as f,b as h,J as b,w as k,N as X,Q as N,F as C,G as E,e as _,p as d,au as J,Z as P,r as Q,O as U,m as g,t as H,a0 as Z}from"./framework.D1sHVKzl.js";import{e as W,M as F,Z as j,X as B}from"./index.B_-AZqtN.js";function A(r){const t={x:r.clientX,y:r.clientY},o=r.changedTouches;return o&&(t.x=o[0].clientX,t.y=o[0].clientY),(!t.x||t.x<0)&&(t.x=0),(!t.y||t.y<0)&&(t.y=0),t}function G(r,t,o){if(r){const{innerWidth:a,innerHeight:x}=window,{offsetWidth:i,offsetHeight:e}=r;t+i>a&&(t-=t+i-a),o+e>x&&(o-=o+e-x)}return{x:t,y:o}}const R=Symbol(),L={key:0,class:"icon"},q={class:"ellipsis"},K={key:0,class:"icon"},ee={class:"ellipsis"},ne={key:0,class:"icon"},te=["onMousedown"],le={class:"ellipsis"},ie=D({__name:"menu-item",props:{menu:{}},setup(r){const{onClick:t,itemHeight:o,fontSize:a}=U(R)||{},x=e=>{var u;return!!((u=e.children)!=null&&u.length)},i=(e,u)=>{var v;u.disabled||((v=u.onClick)==null||v.call(u),t==null||t(e,u))};return(e,u)=>{const v=w("el-menu-item"),S=w("menu-item",!0),M=w("el-sub-menu");return x(e.menu)?(l(),h(M,{key:1,index:e.menu.command},{title:k(()=>{var n,m,p;return[(n=e.menu)!=null&&n.icon?(l(),f("div",K,[b(d(B),{size:d(a),icon:(m=e.menu)==null?void 0:m.icon},null,8,["size","icon"])])):_("v-if",!0),g("span",ee,H((p=e.menu)==null?void 0:p.title),1)]}),default:k(()=>[(l(!0),f(C,null,E(e.menu.children,n=>{var m;return l(),f(C,{key:n.command},[(m=n.children)!=null&&m.length?(l(),h(S,{key:1,menu:n},null,8,["menu"])):(l(),h(v,{key:0,style:N({"--el-menu-item-height":`${d(o)}px`}),disabled:e.menu.disabled,index:n.command},{default:k(()=>[n!=null&&n.icon?(l(),f("div",ne,[b(d(B),{size:d(a),icon:n==null?void 0:n.icon},null,8,["size","icon"])])):_("v-if",!0),g("div",{onMousedown:Z(p=>i(n.command,n),["stop"])},[g("span",le,H(n==null?void 0:n.title),1)],40,te)]),_:2},1032,["style","disabled","index"]))],64)}),128))]),_:1},8,["index"])):(l(),h(v,{key:0,style:N({"--el-menu-item-height":`${d(o)}px`}),disabled:e.menu.disabled,index:e.menu.command},{default:k(()=>{var n,m,p;return[g("div",{class:"menu-item",onMousedown:u[0]||(u[0]=Z(s=>i(e.menu.command,e.menu),["stop"]))},[(n=e.menu)!=null&&n.icon?(l(),f("div",L,[b(d(B),{size:d(a),icon:(m=e.menu)==null?void 0:m.icon},null,8,["size","icon"])])):_("v-if",!0),g("span",q,H((p=e.menu)==null?void 0:p.title),1)],32)]}),_:1},8,["style","disabled","index"]))}}}),se=F(ie,[["__scopeId","data-v-9481e936"]]),oe=D({name:"ProContextMenu",inheritAttrs:!1,__name:"context-menu",props:{menus:{default:()=>[]},closeOnClick:{type:Boolean,default:!0},trigger:{default:()=>["contextmenu"]},itemHeight:{default:40},fontSize:{default:14}},emits:["click-menu"],setup(r,{expose:t,emit:o}){const a=r,x=o,i=V({x:0,y:0,visible:!1});Y(R,{onClick:p,itemHeight:a.itemHeight,fontSize:a.fontSize});const e=$(),u=$(),v=$(),S=O(()=>({left:`${i.x}px`,top:`${i.y}px`})),M=O(()=>{const s={};return a.trigger.forEach(y=>{s[y]=c=>{c.preventDefault(),n(c)}}),s});function n(s){i.visible=!0,I(()=>{var y;(y=e.value)==null||y.focus();const c=A(s);if(e.value){const{x:z,y:T}=G(e.value,c.x,c.y);c.x=z,c.y=T}i.x=c.x,i.y=c.y})}const m=()=>{i.visible=!1};function p(s,y){x("click-menu",s,y),y.closeOnClick!==!1&&a.closeOnClick&&(i.visible=!1)}return t({show:n}),(s,y)=>{const c=w("el-menu");return l(),f(C,null,[(l(),h(J,{to:"body"},[b(d(j),null,{default:k(()=>[i.visible?(l(),f("div",X({key:0},s.$attrs,{ref_key:"contextMenuRef",ref:e,class:"context-menu",style:S.value,tabindex:-1,onBlur:m}),[b(c,{ref_key:"menuRef",ref:v,collapse:!0,"collapse-transition":!1,router:!1,"close-on-click-outside":!0,teleported:!1,style:N({"--el-menu-item-height":`${s.itemHeight}px`,"--el-menu-item-font-size":`${s.fontSize}px`})},{default:k(()=>[(l(!0),f(C,null,E(s.menus,z=>(l(),h(se,{key:z.name,menu:z},null,8,["menu"]))),128))]),_:1},8,["style"])],16)):_("v-if",!0)]),_:1})])),s.$slots.default?(l(),f("span",X({key:0,ref_key:"triggerRef",ref:u,class:"context-menu-trigger"},P(M.value,!0)),[Q(s.$slots,"default",{},void 0,!0)],16)):_("v-if",!0)],64)}}}),ue=F(oe,[["__scopeId","data-v-91168cd9"]]),me=W(ue);export{me as m};
