import{O as C,K as L,P as k,Q as A,U as w,V as x,Y as U,Z as F,a0 as f}from"./index.OAlBif3f.js";import{d as V,h as _,E as s,o as z,b as B,w as m,J as y,a as I,bb as N}from"./framework.D1HSi6sf.js";import"./theme.BC9Oi9St.js";const $=/;(?![^(]*\))/g,j=/:([^]+)/,D=/\/\*[^]*?\*\//g;function R(e){const t={};return e.replace(D,"").split($).forEach(n=>{if(n){const r=n.split(j);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}const X={color:{property:"color",handler:e=>u(e)},backgroundColor:{property:"shading",handler:e=>({type:U.SOLID,color:u(e),fill:u(e)})},textDecoration:{property:"underline",handler:(e,t)=>({type:F.SINGLE,color:t.color?u(t.color):void 0})},fontSize:{property:"size",handler:e=>H(e)},textIndent:{property:"indent",handler:(e,t)=>{const n=d(t.fontSize),r=d(e);return{firstLine:K(n*r)}}},textAlign:{property:"alignment",handler:e=>e==="center"?f.CENTER:e==="right"?f.RIGHT:f.LEFT},fontWeight:{property:"bold",handler:e=>!!e},fontFamily:{property:"font",handler:e=>e},lineHeight:{property:"lineSpacing",handler:e=>{if(e)return d(e)*20}}},q={em:{property:"italics",handler:()=>!0},strong:{property:"bold",handler:()=>!0}};function g(e){const t={};return Object.keys(e).forEach(n=>{const r=N(n),o=e[n],a=X[r];if(a){t[a.property]=a.handler(o,e);return}t[r]=o}),t}function G(e){const t={};return e.forEach(n=>{const r=q[n];r&&(t[r.property]=r.handler())}),t}function E(e){var t;const n={},r=R(((t=e==null?void 0:e.style)==null?void 0:t.cssText)||"");return Object.keys(r).forEach(o=>{n[N(o)]=r[o]}),n}function H(e){return d(e)*2}function K(e){return e*20}function d(e){const t=e.match(/(\d+(\.\d+)?)/);return t?parseFloat(t[0]):0}function u(e){if(M(e))return e;const t=e.match(/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*[\d.]+)?\)$/);function n(r){const o=Number(r).toString(16);return o.length===1?"0"+o:o}if(t){const r=n(t[1]),o=n(t[2]),a=n(t[3]);return"#"+r+o+a}else return e}function M(e){return/^#(?:[A-Fa-f0-9]{3}){1,2}$|^#(?:[A-Fa-f0-9]{4}){1,2}$/.test(e)}function P(e){const t=[];return(Array.isArray(e)?e:[e]).forEach(n=>{t.push(new w({pageBreakBefore:!0})),t.push(...J(n))}),t}function J(e){const t=document.createElement("div");t.innerHTML=e;const n=new DOMParser().parseFromString(e,"text/html"),r=[];return n.body.querySelectorAll("p,h1,h2,h3,h4,h6").forEach(o=>{const a=[],c=g(E(o));o.childNodes.forEach(i=>{if(i.nodeType===Node.TEXT_NODE)a.push(new x({text:i.textContent||"",...b(g(E(i)),c)}));else if(i.nodeType===Node.ELEMENT_NODE){const l=i,h=["strong","em","i"],T=Array.from(l.querySelectorAll("strong,em, i")).map(S=>S.tagName.toLowerCase()),v=G(T),O=b(b(g(E(l)),c),v);h.includes(l.tagName.toLowerCase())||a.push(new x({text:l.textContent,...O}))}});const p=new w({children:a,spacing:{line:c.lineSpacing,lineRule:"exact"},alignment:c.alignment,indent:c.indent});r.push(p)}),r}function b(e,t){return Object.keys(t).forEach(n=>{t[n]!==void 0&&(e[n]=t[n])}),e}function W(e,t){Y(Z(e)).then(n=>{const r=URL.createObjectURL(n);L(r,t?`${t}.docx`:void 0)})}function Y(e){return k.toBlob(e)}function Z(e){return new A({features:{updateFields:!0},sections:[{properties:{page:{margin:{top:1814,bottom:1814,left:1417,right:1417},size:{width:11906,height:16838}}},children:P(e)}]})}const ne=V({__name:"html-to-docx",setup(e){const t=C(),n=_(""),r=()=>{W(n.value,t.meta.title)};return(o,a)=>{const c=s("el-button"),p=s("pro-tinymce"),i=s("page-card"),l=s("page-wrapper");return z(),B(l,null,{default:m(()=>[y(i,{header:o.$route.meta.title},{default:m(()=>[y(c,{type:"primary",class:"mb-20px",onClick:r},{default:m(()=>[I("导出 word")]),_:1}),y(p,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=h=>n.value=h)},null,8,["modelValue"])]),_:1},8,["header"])]),_:1})}}});export{ne as default};
