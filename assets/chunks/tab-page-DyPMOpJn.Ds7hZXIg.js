import{a as q,D,u as E}from"./index.B_-AZqtN.js";import{h as v,k as r,p as O}from"./framework.D1sHVKzl.js";function o(n){return n.meta.affixTab}function R(n){return{name:n.name,fullPath:n.fullPath,meta:n.meta,query:n.query,params:n.params}}const S=q("tab-page",()=>{const n=v(new Set),l=v([]),t=v(null),P=v([]),b=r(()=>Array.from(n.value)),c=r(()=>l.value),d=r(()=>t.value),T=r(()=>P.value);function A(e){if(e.meta.hideInTab)return;const a=R(e),u=O(l);u.length===0?u.push(a):u.find(f=>f.name===a.name&&f.fullPath===a.fullPath)||u.push(a),i(),t.value=a}function x(e,a){var u;const f=a||t.value;if(!f)return;const p=c.value.find(k=>f.fullPath===k.fullPath);p&&(p.meta.title=(u=e.meta)==null?void 0:u.title,i())}function y(e){l.value[e].meta.affixTab||(l.value.splice(e,1),i(),g())}function C(){s(),t.value=null,i(),g()}function I(){s(),t.value&&!o(t.value)&&l.value.push(t.value)}function K(e){let a=e!==void 0&&e>=0?e:l.value.findIndex(u=>{var f;return u.fullPath===((f=t.value)==null?void 0:f.fullPath)});if(a!==-1)for(let u=0;u<a;u++)o(l.value[u])||(l.value.splice(u,1),u--,a--)}function L(){if(!l.value.length)return;const e=l.value.findIndex(a=>{var u;return a.fullPath===((u=t.value)==null?void 0:u.fullPath)});if(e!==-1)for(let a=l.value.length-1;a>e;a--)o(l.value[a])||l.value.splice(a,1)}function s(){l.value=l.value.filter(e=>e.meta.affixTab)}function m(e){D.push({path:e.fullPath}),t.value=e}function i(){if(E.keepAliveCachePolicy!=="tab")return;const e=l.value.filter(a=>a.meta.ignoreKeepAlive).map(a=>a.name);n.value.clear(),e.forEach(a=>{h(a)})}function h(e){n.value.add(e)}function g(){const e=l.value.length-1;e<0||(t.value=l.value[e],m(t.value))}return{isAffixTab:o,addTabPage:A,removeTabPage:y,removeAllTabPage:C,removeOhterTabPages:I,removeLeftAllTabPages:K,removeRightAllTabPages:L,updateTabPage:x,addKeepAlive:h,goTabPage:m,getTabPages:c,getAffixTabsList:T,getKeepAliveCache:b,getCurrentActivityTabPage:d}});export{S as O};
