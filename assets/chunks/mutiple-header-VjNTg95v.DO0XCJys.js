import{i as L}from"./index.OAlBif3f.js";import{f as R}from"./index-rzEixQxK.Bl_qYJGh.js";import{d as w,h as P,E as u,o as b,b as D,w as s,J as c,p as N,a as k}from"./framework.D1HSi6sf.js";import"./theme.BC9Oi9St.js";const j=w({__name:"mutiple-header",setup($){const d=P([]),{register:y,getTableRef:_}=L();d.value=A();const m=[{title:"ID",key:"id"},{title:"姓名",key:"namer",children:[{title:"姓名1",key:"name1",children:[{title:"姓名",key:"name",children:[]},{title:"姓名2",key:"name2",children:[]}]},{title:"姓名2",key:"name1",children:[]}]},{title:"年龄",key:"age"},{title:"编号",key:"code"},{title:"地址",key:"address"},{title:"开始时间",key:"startTime"},{title:"结束时间",key:"endTime"}],C=({row:o,column:t,rowIndex:e,columnIndex:i})=>{if(e%2===0){if(i===0)return[1,2];if(i===1)return[0,0]}},x=async()=>{const o=h(m);T(o);const t=await _();console.log("tableRef",t)},E=()=>{const o={};m.forEach(e=>{o[e.key]=e.title});const t=h(m);R({data:[],merges:[],header:t,filename:`${new Date().getTime()}.xlsx`,json2sheetOpts:{header:t},write2excelOpts:{bookType:"xlsx"}})};function h(o){let t=[];f(o,t,0,0);let e=Math.max(...t.map(i=>i.length));return t.filter(i=>i.length<e).forEach(i=>p(i,e-i.length)),t}function f(o,t,e,i){let n=0,a=t[e];a||(a=t[e]=[]),p(a,i-a.length);for(let r=0;r<o.length;r++){let l=o[r];if(a.push(l.title),l.hasOwnProperty("children")&&Array.isArray(l.children)&&l.children.length>0){let g=f(l.children,t,e+1,a.length-1);O(a,g-1),n+=g}else n++}return n}function O(o,t){for(let e=0;e<t;e++)o.push("!$COL_SPAN_PLACEHOLDER")}function p(o,t){for(let e=0;e<t;e++)o.push("!$ROW_SPAN_PLACEHOLDER")}function T(o){let t=o.length,e=[];for(let n=0;n<t;n++){let a=o[n],r=0;for(let l=0;l<a.length;l++)a[l]==="!$COL_SPAN_PLACEHOLDER"?(a[l]=void 0,l+1===a.length&&e.push({s:{r:n,c:l-r-1},e:{r:n,c:l}}),r++):(r>0&&l>r&&e.push({s:{r:n,c:l-r-1},e:{r:n,c:l-1}}),r=0)}let i=o[0].length;for(let n=0;n<i;n++){let a=0;for(let r=0;r<t;r++)o[r][n]==="!$ROW_SPAN_PLACEHOLDER"?(o[r][n]=void 0,a++,r+1===t&&e.push({s:{r:r-a,c:n},e:{r,c:n}})):(a>0&&r>a&&e.push({s:{r:r-a-1,c:n},e:{r:r-1,c:n}}),a=0)}return e}function A(){return[{id:"12987122",name:"Tom",amount1:"234",amount2:"3.2",amount3:10},{id:"12987123",name:"Tom",amount1:"165",amount2:"4.43",amount3:12},{id:"12987124",name:"Tom",amount1:"324",amount2:"1.9",amount3:9},{id:"12987125",name:"Tom",amount1:"621",amount2:"2.2",amount3:17},{id:"12987126",name:"Tom",amount1:"539",amount2:"4.1",amount3:15}]}return(o,t)=>{const e=u("el-button"),i=u("pro-table"),n=u("page-card"),a=u("page-wrapper");return b(),D(a,null,{default:s(()=>[c(n,{header:o.$route.meta.title},{default:s(()=>[c(i,{columns:m,data:d.value,"span-method":C,onRegister:N(y)},{toolbar:s(()=>[c(e,{onClick:x},{default:s(()=>[k("数组方式导出")]),_:1}),c(e,{onClick:E},{default:s(()=>[k("导出")]),_:1})]),_:1},8,["data","onRegister"])]),_:1},8,["header"])]),_:1})}}});export{j as default};
