import{z as L,Q as C,x as F,A as s,a as O,n as _,b as f,W as m,G as k,az as z,aA as D,aB as $,aC as w,aD as x,aE as A,aF as j,aG as G,aH as g}from"./index.CXx_r3g5.js";import"./framework.CtQlGyLl.js";import"./theme.lKphzJcC.js";const H=/;(?![^(]*\))/g,I=/:([^]+)/,R=/\/\*[^]*?\*\//g;function q(e){const t={};return e.replace(R,"").split(H).forEach(n=>{if(n){const r=n.split(I);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}const B={color:{property:"color",handler:e=>u(e)},backgroundColor:{property:"shading",handler:e=>({type:j.SOLID,color:u(e),fill:u(e)})},textDecoration:{property:"underline",handler:(e,t)=>({type:G.SINGLE,color:t.color?u(t.color):void 0})},fontSize:{property:"size",handler:e=>V(e)},textIndent:{property:"indent",handler:(e,t)=>{const n=p(t.fontSize),r=p(e);return{firstLine:W(n*r)}}},textAlign:{property:"alignment",handler:e=>e==="center"?g.CENTER:e==="right"?g.RIGHT:g.LEFT},fontWeight:{property:"bold",handler:e=>!!e},fontFamily:{property:"font",handler:e=>e},lineHeight:{property:"lineSpacing",handler:e=>{if(e)return p(e)*20}}},M={em:{property:"italics",handler:()=>!0},strong:{property:"bold",handler:()=>!0}};function y(e){const t={};return Object.keys(e).forEach(n=>{const r=A(n),o=e[n],a=B[r];if(a){t[a.property]=a.handler(o,e);return}t[r]=o}),t}function U(e){const t={};return e.forEach(n=>{const r=M[n];r&&(t[r.property]=r.handler())}),t}function E(e){var t;const n={},r=q(((t=e==null?void 0:e.style)==null?void 0:t.cssText)||"");return Object.keys(r).forEach(o=>{n[A(o)]=r[o]}),n}function V(e){return p(e)*2}function W(e){return e*20}function p(e){const t=e.match(/(\d+(\.\d+)?)/);return t?parseFloat(t[0]):0}function u(e){if(X(e))return e;const t=e.match(/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*[\d.]+)?\)$/);function n(r){const o=Number(r).toString(16);return o.length===1?"0"+o:o}if(t){const r=n(t[1]),o=n(t[2]),a=n(t[3]);return"#"+r+o+a}else return e}function X(e){return/^#(?:[A-Fa-f0-9]{3}){1,2}$|^#(?:[A-Fa-f0-9]{4}){1,2}$/.test(e)}function Z(e){const t=[];return(Array.isArray(e)?e:[e]).forEach(n=>{t.push(new w({pageBreakBefore:!0})),t.push(...P(n))}),t}function P(e){const t=document.createElement("div");t.innerHTML=e;const n=new DOMParser().parseFromString(e,"text/html"),r=[];return n.body.querySelectorAll("p,h1,h2,h3,h4,h6").forEach(o=>{const a=[],i=y(E(o));o.childNodes.forEach(l=>{if(l.nodeType===Node.TEXT_NODE)a.push(new x({text:l.textContent||"",...b(y(E(l)),i)}));else if(l.nodeType===Node.ELEMENT_NODE){const c=l,h=["strong","em","i"],N=Array.from(c.querySelectorAll("strong,em, i")).map(v=>v.tagName.toLowerCase()),S=U(N),T=b(b(y(E(c)),i),S);h.includes(c.tagName.toLowerCase())||a.push(new x({text:c.textContent,...T}))}});const d=new w({children:a,spacing:{line:i.lineSpacing,lineRule:"exact"},alignment:i.alignment,indent:i.indent});r.push(d)}),r}function b(e,t){return Object.keys(t).forEach(n=>{t[n]!==void 0&&(e[n]=t[n])}),e}function Q(e,t){J(K(e)).then(n=>{const r=URL.createObjectURL(n);z(r,t?`${t}.docx`:void 0)})}function J(e){return D.toBlob(e)}function K(e){return new $({features:{updateFields:!0},sections:[{properties:{page:{margin:{top:1814,bottom:1814,left:1417,right:1417},size:{width:11906,height:16838}}},children:Z(e)}]})}const ne=L({__name:"html-to-docx",setup(e){const t=C(),n=F(""),r=()=>{Q(n.value,t.meta.title)};return(o,a)=>{const i=s("el-button"),d=s("pro-tinymce"),l=s("page-card"),c=s("page-wrapper");return O(),_(c,null,{default:f(()=>[m(l,{header:o.$route.meta.title},{default:f(()=>[m(i,{type:"primary",class:"mb-20px",onClick:r},{default:f(()=>[k("导出 word")]),_:1}),m(d,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=h=>n.value=h)},null,8,["modelValue"])]),_:1},8,["header"])]),_:1})}}});export{ne as default};
